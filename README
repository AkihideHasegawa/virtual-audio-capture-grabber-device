See http://betterlogic.com/roger/2010/08/open-source-audio-sniffergrabber-for-windows-7vista for description.

Basically, it's an audio capture device for all "wave out sound" that is playing on your speakers (record what you hear).
It works for windows 7/Vista, which comes without a default capture for most soundcards, it seems.

To install, as an administrator go to the Release subdirectory, and run
C:\...source_code\acam\Release> regsvr32 audio_sniffer.ax

To uninstall:

C:\...source_code\acam\Release> regsvr32 /u audio_sniffer.ax

ping me if you want this installation made easier :)

Then you can then use it in VLC or whatever directshow compatible player/recorder you have as a new input device.

Troubleshooting.

If you use it in VLC you'll need a directshow cache of at least 40ms, for some odd reason.
Also note that it's tuned currently to work best for recording "what you hear" if this doesn't work for you then ping
me I can add a "realtime" option or the like.
Any feedback welcome, including feature requests like "support more audio channels than 2".

rogerdpack@gmail.com or mailing list http://groups.google.com/group/roger-projects

Some source code from the windows SDK samples, some taken from 
http://blogs.msdn.com/b/matthew_van_eerde/archive/2008/12/16/sample-wasapi-loopback-capture-record-what-you-hear.aspx
